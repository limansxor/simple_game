<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ëª¨ì§€ ë±€íŒŒì´ì–´ ì„œë°”ì´ë²Œ</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        
        #gameCanvas {
            border: 3px solid #ff6b6b;
            background: #0f0f23;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.3);
        }
        
        .ui {
            display: flex;
            gap: 20px;
            margin: 10px 0;
            font-size: 18px;
            font-weight: bold;
        }
        
        .controls {
            margin: 10px 0;
            text-align: center;
        }
        
        button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        
        button:hover {
            background: #ff5252;
        }
        
        .game-over {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            display: none;
        }
    </style>
</head>
<body>
    <h1>ğŸ§› ì´ëª¨ì§€ ë±€íŒŒì´ì–´ ì„œë°”ì´ë²Œ ğŸ§›</h1>
    
    <div class="ui">
        <div>â¤ï¸ HP: <span id="hp">100</span></div>
        <div>â­ ë ˆë²¨: <span id="level">1</span></div>
        <div>ğŸ’€ ì²˜ì¹˜: <span id="kills">0</span></div>
        <div>â° ì‹œê°„: <span id="time">0</span>s</div>
        <div>ğŸ¯ ë‚œì´ë„: <span id="difficulty">1</span>/8</div>
    </div>
    
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    
    <div class="controls">
        <p>ğŸ–±ï¸ ë§ˆìš°ìŠ¤ë¡œ ì´ë™ (WASD/ë°©í–¥í‚¤ë„ ê°€ëŠ¥)</p>
        <button onclick="startGame()">ğŸ® ê²Œì„ ì‹œì‘</button>
        <button onclick="pauseGame()">â¸ï¸ ì¼ì‹œì •ì§€</button>
    </div>
    
    <div id="gameOver" class="game-over">
        <h2>ğŸ’€ ê²Œì„ ì˜¤ë²„ ğŸ’€</h2>
        <p>ìƒì¡´ ì‹œê°„: <span id="finalTime">0</span>ì´ˆ</p>
        <p>ì²˜ì¹˜í•œ ì : <span id="finalKills">0</span>ë§ˆë¦¬</p>
        <p>ë„ë‹¬ ë‚œì´ë„: <span id="finalDifficulty">1</span></p>
        <button onclick="restartGame()">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let gameState = {
            player: { x: 400, y: 300, hp: 100, maxHp: 100 },
            enemies: [],
            bullets: [],
            powerUps: [],
            level: 1,
            kills: 0,
            time: 0,
            difficulty: 1,
            gameRunning: false,
            paused: false
        };
        
        let keys = {};
        let lastTime = 0;
        let spawnTimer = 0;
        let shootTimer = 0;
        let difficultyTimer = 0;
        
        // ì´ëª¨ì§€ ì„¤ì •
        const emojis = {
            player: 'ğŸ§™â€â™‚ï¸',
            enemies: ['ğŸ‘»', 'ğŸ’€', 'ğŸ•·ï¸', 'ğŸ¦‡', 'ğŸ‘¹', 'ğŸº', 'ğŸ§Ÿâ€â™‚ï¸', 'ğŸ‘¿'],
            bullet: 'âœ¨',
            powerUp: 'ğŸ’',
            heart: 'â¤ï¸'
        };
        
        // ë‚œì´ë„ë³„ ì„¤ì • (ëª¬ìŠ¤í„° ìˆ˜ 10ë°° ì¦ê°€)
        const difficultySettings = [
            { enemySpeed: 0.5, spawnRate: 200, enemyHp: 1, enemyDamage: 10 },
            { enemySpeed: 0.7, spawnRate: 180, enemyHp: 1, enemyDamage: 12 },
            { enemySpeed: 0.9, spawnRate: 160, enemyHp: 2, enemyDamage: 15 },
            { enemySpeed: 1.1, spawnRate: 140, enemyHp: 2, enemyDamage: 18 },
            { enemySpeed: 1.3, spawnRate: 120, enemyHp: 3, enemyDamage: 20 },
            { enemySpeed: 1.5, spawnRate: 100, enemyHp: 3, enemyDamage: 25 },
            { enemySpeed: 1.7, spawnRate: 80, enemyHp: 4, enemyDamage: 30 },
            { enemySpeed: 2.0, spawnRate: 60, enemyHp: 5, enemyDamage: 35 }
        ];
        
        // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
        let mouseX = 400;
        let mouseY = 300;
        
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;
        });
        
        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ (ë°±ì—…ìš©)
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });
        
        function drawEmoji(emoji, x, y, size = 30) {
            ctx.font = `${size}px Arial`;
            ctx.textAlign = 'center';
            ctx.fillText(emoji, x, y + size/3);
        }
        
        function spawnEnemy() {
            const side = Math.floor(Math.random() * 4);
            let x, y;
            
            switch(side) {
                case 0: x = Math.random() * canvas.width; y = -30; break;
                case 1: x = canvas.width + 30; y = Math.random() * canvas.height; break;
                case 2: x = Math.random() * canvas.width; y = canvas.height + 30; break;
                case 3: x = -30; y = Math.random() * canvas.height; break;
            }
            
            const settings = difficultySettings[gameState.difficulty - 1];
            const enemyType = Math.min(gameState.difficulty - 1, emojis.enemies.length - 1);
            
            gameState.enemies.push({
                x: x,
                y: y,
                hp: settings.enemyHp,
                maxHp: settings.enemyHp,
                damage: settings.enemyDamage,
                speed: settings.enemySpeed,
                emoji: emojis.enemies[enemyType]
            });
        }
        
        function shootBullet() {
            if (gameState.enemies.length === 0) return;
            
            // ê°€ì¥ ê°€ê¹Œìš´ ì  ì°¾ê¸°
            let closestEnemy = null;
            let closestDistance = Infinity;
            
            gameState.enemies.forEach(enemy => {
                const distance = Math.sqrt(
                    Math.pow(enemy.x - gameState.player.x, 2) + 
                    Math.pow(enemy.y - gameState.player.y, 2)
                );
                if (distance < closestDistance) {
                    closestDistance = distance;
                    closestEnemy = enemy;
                }
            });
            
            if (closestEnemy) {
                const angle = Math.atan2(
                    closestEnemy.y - gameState.player.y,
                    closestEnemy.x - gameState.player.x
                );
                
                gameState.bullets.push({
                    x: gameState.player.x,
                    y: gameState.player.y,
                    vx: Math.cos(angle) * 5,
                    vy: Math.sin(angle) * 5,
                    damage: gameState.level
                });
            }
        }
        
        function updateGame(deltaTime) {
            if (!gameState.gameRunning || gameState.paused) return;
            
            // ì‹œê°„ ì—…ë°ì´íŠ¸
            gameState.time += deltaTime / 1000;
            
            // ë‚œì´ë„ ì¦ê°€ (30ì´ˆë§ˆë‹¤)
            difficultyTimer += deltaTime;
            if (difficultyTimer >= 30000 && gameState.difficulty < 8) {
                gameState.difficulty++;
                difficultyTimer = 0;
            }
            
            // í”Œë ˆì´ì–´ ì´ë™ (ë§ˆìš°ìŠ¤ ì¶”ì )
            const dx = mouseX - gameState.player.x;
            const dy = mouseY - gameState.player.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > 5) { // ë§ˆìš°ìŠ¤ì— ë„ˆë¬´ ê°€ê¹Œìš°ë©´ ì›€ì§ì´ì§€ ì•ŠìŒ
                const speed = 3;
                const moveX = (dx / distance) * speed;
                const moveY = (dy / distance) * speed;
                
                gameState.player.x = Math.max(15, Math.min(canvas.width - 15, gameState.player.x + moveX));
                gameState.player.y = Math.max(15, Math.min(canvas.height - 15, gameState.player.y + moveY));
            }
            
            // í‚¤ë³´ë“œ ì´ë™ (ë°±ì—…)
            const keySpeed = 3;
            if (keys['w'] || keys['arrowup']) gameState.player.y = Math.max(15, gameState.player.y - keySpeed);
            if (keys['s'] || keys['arrowdown']) gameState.player.y = Math.min(canvas.height - 15, gameState.player.y + keySpeed);
            if (keys['a'] || keys['arrowleft']) gameState.player.x = Math.max(15, gameState.player.x - keySpeed);
            if (keys['d'] || keys['arrowright']) gameState.player.x = Math.min(canvas.width - 15, gameState.player.x + keySpeed);
            
            // ì  ìƒì„±
            const settings = difficultySettings[gameState.difficulty - 1];
            spawnTimer += deltaTime;
            if (spawnTimer >= settings.spawnRate) {
                spawnEnemy();
                spawnTimer = 0;
            }
            
            // ì´ì•Œ ë°œì‚¬
            shootTimer += deltaTime;
            if (shootTimer >= 300) {
                shootBullet();
                shootTimer = 0;
            }
            
            // ì  ì—…ë°ì´íŠ¸
            gameState.enemies.forEach((enemy, enemyIndex) => {
                const angle = Math.atan2(
                    gameState.player.y - enemy.y,
                    gameState.player.x - enemy.x
                );
                enemy.x += Math.cos(angle) * enemy.speed;
                enemy.y += Math.sin(angle) * enemy.speed;
                
                // í”Œë ˆì´ì–´ì™€ ì¶©ëŒ ì²´í¬
                const distance = Math.sqrt(
                    Math.pow(enemy.x - gameState.player.x, 2) + 
                    Math.pow(enemy.y - gameState.player.y, 2)
                );
                
                if (distance < 25) {
                    gameState.player.hp -= enemy.damage;
                    gameState.enemies.splice(enemyIndex, 1);
                    
                    if (gameState.player.hp <= 0) {
                        endGame();
                    }
                }
            });
            
            // ì´ì•Œ ì—…ë°ì´íŠ¸
            gameState.bullets.forEach((bullet, bulletIndex) => {
                bullet.x += bullet.vx;
                bullet.y += bullet.vy;
                
                // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°„ ì´ì•Œ ì œê±°
                if (bullet.x < 0 || bullet.x > canvas.width || 
                    bullet.y < 0 || bullet.y > canvas.height) {
                    gameState.bullets.splice(bulletIndex, 1);
                    return;
                }
                
                // ì ê³¼ ì¶©ëŒ ì²´í¬
                gameState.enemies.forEach((enemy, enemyIndex) => {
                    const distance = Math.sqrt(
                        Math.pow(enemy.x - bullet.x, 2) + 
                        Math.pow(enemy.y - bullet.y, 2)
                    );
                    
                    if (distance < 20) {
                        enemy.hp -= bullet.damage;
                        gameState.bullets.splice(bulletIndex, 1);
                        
                        if (enemy.hp <= 0) {
                            gameState.enemies.splice(enemyIndex, 1);
                            gameState.kills++;
                            
                            // ë ˆë²¨ì—… (10í‚¬ë§ˆë‹¤)
                            if (gameState.kills % 10 === 0) {
                                gameState.level++;
                                gameState.player.maxHp += 10;
                                gameState.player.hp = Math.min(gameState.player.maxHp, gameState.player.hp + 20);
                            }
                        }
                    }
                });
            });
            
            updateUI();
        }
        
        function render() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // í”Œë ˆì´ì–´ ê·¸ë¦¬ê¸°
            drawEmoji(emojis.player, gameState.player.x, gameState.player.y, 35);
            
            // HP ë°” ê·¸ë¦¬ê¸°
            const hpBarWidth = 60;
            const hpBarHeight = 8;
            const hpPercent = gameState.player.hp / gameState.player.maxHp;
            
            ctx.fillStyle = '#ff4444';
            ctx.fillRect(gameState.player.x - hpBarWidth/2, gameState.player.y - 35, hpBarWidth, hpBarHeight);
            ctx.fillStyle = '#44ff44';
            ctx.fillRect(gameState.player.x - hpBarWidth/2, gameState.player.y - 35, hpBarWidth * hpPercent, hpBarHeight);
            
            // ì  ê·¸ë¦¬ê¸°
            gameState.enemies.forEach(enemy => {
                drawEmoji(enemy.emoji, enemy.x, enemy.y, 25);
                
                // ì  HP ë°”
                if (enemy.hp < enemy.maxHp) {
                    const enemyHpBarWidth = 30;
                    const enemyHpBarHeight = 4;
                    const enemyHpPercent = enemy.hp / enemy.maxHp;
                    
                    ctx.fillStyle = '#ff4444';
                    ctx.fillRect(enemy.x - enemyHpBarWidth/2, enemy.y - 25, enemyHpBarWidth, enemyHpBarHeight);
                    ctx.fillStyle = '#44ff44';
                    ctx.fillRect(enemy.x - enemyHpBarWidth/2, enemy.y - 25, enemyHpBarWidth * enemyHpPercent, enemyHpBarHeight);
                }
            });
            
            // ì´ì•Œ ê·¸ë¦¬ê¸°
            gameState.bullets.forEach(bullet => {
                drawEmoji(emojis.bullet, bullet.x, bullet.y, 15);
            });
            
            if (gameState.paused) {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = 'white';
                ctx.font = '40px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('â¸ï¸ ì¼ì‹œì •ì§€', canvas.width/2, canvas.height/2);
            }
        }
        
        function updateUI() {
            document.getElementById('hp').textContent = Math.max(0, Math.floor(gameState.player.hp));
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('kills').textContent = gameState.kills;
            document.getElementById('time').textContent = Math.floor(gameState.time);
            document.getElementById('difficulty').textContent = gameState.difficulty;
        }
        
        function gameLoop(currentTime) {
            const deltaTime = currentTime - lastTime;
            lastTime = currentTime;
            
            updateGame(deltaTime);
            render();
            
            if (gameState.gameRunning) {
                requestAnimationFrame(gameLoop);
            }
        }
        
        function startGame() {
            gameState = {
                player: { x: 400, y: 300, hp: 100, maxHp: 100 },
                enemies: [],
                bullets: [],
                powerUps: [],
                level: 1,
                kills: 0,
                time: 0,
                difficulty: 1,
                gameRunning: true,
                paused: false
            };
            
            spawnTimer = 0;
            shootTimer = 0;
            difficultyTimer = 0;
            
            document.getElementById('gameOver').style.display = 'none';
            updateUI();
            requestAnimationFrame(gameLoop);
        }
        
        function pauseGame() {
            if (gameState.gameRunning) {
                gameState.paused = !gameState.paused;
            }
        }
        
        function endGame() {
            gameState.gameRunning = false;
            document.getElementById('finalTime').textContent = Math.floor(gameState.time);
            document.getElementById('finalKills').textContent = gameState.kills;
            document.getElementById('finalDifficulty').textContent = gameState.difficulty;
            document.getElementById('gameOver').style.display = 'block';
        }
        
        function restartGame() {
            startGame();
        }
        
        // ì´ˆê¸° ë Œë”ë§
        render();
    </script>
</body>
</html>